(function(g){g.fn.noisy=function(a){function m(a){return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null}a=g.extend({},g.fn.noisy.defaults,a);"undefined"!==typeof a.color&&(a.randomColors=!1);var f,h,b=!1;try{h=!0,localStorage.setItem("test",""),localStorage.removeItem("test"),b=localStorage.getItem(window.JSON.stringify(a))}catch(p){h=!1}if(b)f=b;else{b=document.createElement("canvas");if(b.getContext){b.width=b.height=a.size;
for(var k=b.getContext("2d"),c=k.createImageData(b.width,b.height),l=Math.round(a.intensity*Math.pow(a.size,2)),n=255*a.opacity;l--;){var d=~~(Math.random()*b.width),e=~~(Math.random()*b.height),d=4*(d+e*c.width);a.randomColors?(e=l%255,c.data[d]=e,c.data[d+1]=a.monochrome?e:~~(255*Math.random()),c.data[d+2]=a.monochrome?e:~~(255*Math.random())):(e=m(a.color),c.data[d]=e.r,c.data[d+1]=e.g,c.data[d+2]=e.b);c.data[d+3]=~~(Math.random()*n)}k.putImageData(c,0,0);f=b.toDataURL("image/png");0!=f.indexOf("data:image/png")&&
(f=a.fallback)}else f=a.fallback;window.JSON&&h&&localStorage.setItem(window.JSON.stringify(a),f)}return this.each(function(){g(this).css("background-image","url('"+f+"'),"+g(this).css("background-image"))})};g.fn.noisy.defaults={intensity:0.9,size:200,opacity:0.08,fallback:"",monochrome:!1,randomColors:!0,color:"#000000"}})(jQuery);
